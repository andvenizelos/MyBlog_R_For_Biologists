download_link(
link = "https://github.com/andvenizelos/MyBlog_R_For_Biologists/blob/main/Tip.1/Encode_HMM_data.txt",
button_label = "Download txt file",
button_type = "danger",
has_icon = TRUE,
icon = "fa fa-save",
self_contained = FALSE
)
library(downloadthis)
install.packages("downloadthis")
install.packages("downloadthis")
library(downloadthis)
download_link(
link = "https://github.com/andvenizelos/MyBlog_R_For_Biologists/blob/main/Tip.1/Encode_HMM_data.txt",
button_label = "Download txt file",
button_type = "danger",
has_icon = TRUE,
icon = "fa fa-save",
self_contained = FALSE
)
library(data.table)
library(dplyr)
library(tidyverse)
filename <- "Encode_HMM_data.txt"
library(data.table)
my_data <- fread(filename)
setwd("~/Downloads/PRO")
setwd("~/Documents/Running_Projects/MyWebPage/content/blog/example/")
filename <- "Encode_HMM_data.txt"
library(data.table)
my_data <- fread(filename)
filename <- "Encode_HMM_data.txt"
my_data <- fread(filename)
getwd()
filename <- "/Users/andreasvenizelos/Documents/Running_Projects/MyWebPage/content/blog/example/Encode_HMM_data.txt"
library(data.table)
my_data <- fread(filename)
filename
my_data
my_data
setwd("~/Documents/Running_Projects/MyWebPage/content/blog/example/")
filename <- "/Encode_HMM_data.txt"
filename <- "Encode_HMM_data.txt"
library(data.table)
my_data <- fread(filename)
setwd("~/Documents/Running_Projects/MyWebPage/content/blog/example/")
filename <- "Encode_HMM_data.txt"
library(data.table)
my_data <- fread(filename)
setwd("~/Documents/Running_Projects/MyWebPage/content/blog/example/")
filename <- "~/Documents/Running_Projects/MyWebPage/content/blog/example/Encode_HMM_data.txt"
filename <- "Encode_HMM_data.txt"
library(data.table)
my_data <- fread(filename)
my_data <- fread(filename)
filename
library(data.table)
my_data <- fread(filename)
p2 <- ddply(p1, .(type, chrom), summarise , no = length(type))
library(plyr)
p2 <- ddply(p1, .(type, chrom), summarise , no = length(type))
p1 <- fread("~/Documents/Running_Projects/MyBlog/MyBlog_R_For_Biologists/Tip.1/Encode_HMM_data.txt")
colnames(p1)[1:4] <- c("chrom","start","stop","type")
p1 <- p1[,c(1:4)]
p1$type <- gsub('[[:digit:]]+_','',p1$type)
library(plyr)
p2 <- ddply(p1, .(type, chrom), summarise , no = length(type))
p2
p2 %>% group_by(type) %>%
mutate(prop = no/sum(no)) %>%
ungroup() %>%
pivot_wider(
id_cols = type,
names_from = chrom,
values_from = prop
)
%>% arrange(-`chr19`) %>%
mutate(type = fct_reorder(type, `chr19`)) %>%
pivot_longer(
cols = -type,
names_to = "chrom",
values_to = "prop"
)
p2 %>% group_by(type) %>%
mutate(prop = no/sum(no)) %>%
ungroup() %>%
pivot_wider(
id_cols = type,
names_from = chrom,
values_from = prop
) %>% arrange(-`chr19`) %>%
mutate(type = fct_reorder(type, `chr19`)) %>%
pivot_longer(
cols = -type,
names_to = "chrom",
values_to = "prop"
)
p2
p2 %>% group_by(type) %>%
mutate(prop = no/sum(no))
p2 %>% group_by(type) %>%
mutate(prop = no/sum(no)) %>%
ungroup() %>%
pivot_wider(
id_cols = type,
names_from = chrom,
values_from = prop
)
p2 %>% group_by(type) %>%
mutate(prop = no/sum(no)) %>%
ungroup() %>%
pivot_wider(
id_cols = type,
names_from = chrom,
values_from = prop
) %>% arrange(-`chr19`) %>%
mutate(type = fct_reorder(type, `chr19`)) %>%
pivot_longer(
cols = -type,
names_to = "chrom",
values_to = "prop"
)
p3 %>%
ggplot(aes(chrom, type)) +
geom_tile(aes(fill = prop)) +
geom_text(aes(label = scales::percent(prop, accuracy = 1)),
size = 3) +
scale_fill_gradient(low = "white",high = palette_light()[1]) +
labs(
title = "Heatmap of chromosomes by type",
x = "Chromosomes",
y = "Type"
)+
theme_tq() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "none",
plot.title = element_text(face = "bold"))
p3 <- p2 %>% group_by(type) %>%
mutate(prop = no/sum(no)) %>%
ungroup() %>%
pivot_wider(
id_cols = type,
names_from = chrom,
values_from = prop
) %>% arrange(-`chr19`) %>%
mutate(type = fct_reorder(type, `chr19`)) %>%
pivot_longer(
cols = -type,
names_to = "chrom",
values_to = "prop"
)
p3 %>%
ggplot(aes(chrom, type)) +
geom_tile(aes(fill = prop)) +
geom_text(aes(label = scales::percent(prop, accuracy = 1)),
size = 3) +
scale_fill_gradient(low = "white",high = palette_light()[1]) +
labs(
title = "Heatmap of chromosomes by type",
x = "Chromosomes",
y = "Type"
)+
theme_tq() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "none",
plot.title = element_text(face = "bold"))
p3 %>%
ggplot(aes(chrom, type)) +
geom_tile(aes(fill = prop)) +
geom_text(aes(label = scales::percent(prop, accuracy = 1)),
size = 3) +
scale_fill_gradient(low = "white",high = palette_light()[1]) +
labs(
title = "Heatmap of chromosomes by type",
x = "Chromosomes",
y = "Type"
)+
theme_tq() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "none",
plot.title = element_text(face = "bold"))
library(tidyverse)
library(timetk)
library(lubridate)
library(furrr)
library(tictoc)
p3 %>%
ggplot(aes(chrom, type)) +
geom_tile(aes(fill = prop)) +
geom_text(aes(label = scales::percent(prop, accuracy = 1)),
size = 3) +
scale_fill_gradient(low = "white",high = palette_light()[1]) +
labs(
title = "Heatmap of chromosomes by type",
x = "Chromosomes",
y = "Type"
)+
theme_tq() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "none",
plot.title = element_text(face = "bold"))
p3 %>%
ggplot(aes(chrom, type)) +
geom_tile(aes(fill = prop)) +
geom_text(aes(label = scales::percent(prop, accuracy = 1)),
size = 3) +
scale_fill_gradient(low = "white",high = palette_light()[1]) +
labs(
title = "Heatmap of chromosomes by type",
x = "Chromosomes",
y = "Type"
)+
theme_tq() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "none",
plot.title = element_text(face = "bold"))
my_data
p2 <- ddply(p1, .(type, chrom), summarise , no = length(type))
p2
p3 <- p2 %>% group_by(type) %>%
mutate(prop = no/sum(no)) %>%
ungroup() %>%
pivot_wider(
id_cols = type,
names_from = chrom,
values_from = prop
) %>% arrange(-`chr19`) %>%
mutate(type = fct_reorder(type, `chr19`)) %>%
pivot_longer(
cols = type,
names_to = "chrom",
values_to = "prop"
)
p3
p3 <- p2 %>% group_by(type) %>%
mutate(prop = no/sum(no)) %>%
ungroup() %>%
pivot_wider(
id_cols = type,
names_from = chrom,
values_from = prop
) %>% arrange(-`chr19`) %>%
mutate(type = fct_reorder(type, `chr19`)) %>%
pivot_longer(
cols = -type,
names_to = "chrom",
values_to = "prop"
)
p3
p3 <- p2 %>% group_by(type) %>%
mutate(prop = no/sum(no)) %>%
ungroup() %>%
pivot_wider(
id_cols = type,
names_from = chrom,
values_from = prop
) %>% arrange(-`chr19`) %>%
mutate(type = fct_reorder(type, `chr19`)) %>%
pivot_longer(
cols = -type,
names_to = "chrom",
values_to = "prop"
)
p3
p3 <- p2 %>% group_by(type) %>%
mutate(prop = no/sum(no)) %>%
ungroup() %>%
pivot_wider(
id_cols = type,
names_from = chrom,
values_from = prop
) %>% arrange(-`chr19`) %>%
mutate(type = fct_reorder(type, `chr19`)) %>%
pivot_longer(
cols = type,
names_to = "chrom",
values_to = "prop"
)
p3
p3 <- p2 %>% group_by(type) %>%
mutate(prop = no/sum(no)) %>%
ungroup() %>%
pivot_wider(
id_cols = type,
names_from = chrom,
values_from = prop
) %>% arrange(-`chr19`) %>%
mutate(type = fct_reorder(type, `chr19`)) %>%
pivot_longer(
cols = -type,
names_to = "chrom",
values_to = "prop"
)
p3
p3 %>%
ggplot(aes(chrom, type)) +
geom_tile(aes(fill = prop)) +
geom_text(aes(label = scales::percent(prop, accuracy = 1)),
size = 3) +
scale_fill_gradient(low = "white",high = palette_light()[1]) +
labs(
title = "Heatmap of chromosomes by type",
x = "Chromosomes",
y = "Type"
)+
theme_tq() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "none",
plot.title = element_text(face = "bold"))
heat <- my_data_final %>%
ggplot(aes(chrom, type)) +
geom_tile(aes(fill = prop)) +
geom_text(aes(label = scales::percent(prop, accuracy = 1)),
size = 3) +
scale_fill_gradient(low = "white",high = palette_light()[1]) +
labs(
title = "Heatmap - Chromosomes by type",
x = "Chromosomes",
y = "Type"
)+
theme_tq() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "none",
plot.title = element_text(face = "bold"))
heat <- my_data_final %>%
ggplot(aes(chrom, type)) +
geom_tile(aes(fill = prop)) +
geom_text(aes(label = scales::percent(prop, accuracy = 1)),
size = 3) +
scale_fill_gradient(low = "white",high = palette_light()[1]) +
labs(
title = "Heatmap - Chromosomes by type",
x = "Chromosomes",
y = "Type"
)+
theme_tq() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "none",
plot.title = element_text(face = "bold"))
library(scales)
